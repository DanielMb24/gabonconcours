services:
  - type: web
    name: gabonconcours-v5
    env: node
    region: oregon
    plan: free

    # Commande pour build complet (backend + frontend)
    buildCommand: |
      # Installer les dépendances backend
      cd backend && npm install
      # Installer et builder le frontend
      cd ../frontend && npm install && npm run build

    # Commande pour démarrer le serveur
    startCommand: cd backend && npm start

    # Variables d'environnement
    envVars:
      NODE_ENV: production
      DB_HOST: tramway.proxy.rlwy.net
      DB_PORT: "16318"
      DB_USER: root
      DB_PASSWORD: DCGmuHAEJBSNCBrJjdnhFJyLLCNzopSZ
      DB_NAME: railway
      PORT: 10000

    # Optionnel : ajuster la version Node si nécessaire
    plan: free
    env: node
    nodeVersion: 22.16.0
